\section{Theory}
\subsection{Centrifuge properties}

The present work uses the analytical solution by R\"aetz \cite{raetz.phd} of the
differential equation for the gas centrifuge as described in \cite{glaser.2008}.
Centrifuge parameters, such as average gas temperature, $T$, peripheral speed,
$v$, height, $h$, diameter, $d$, pressure ratio, $x$, feed flow rate, $F$,
counter-current flow ratio, $L/P$, and efficiency, $e$ have been chosen (Table
\ref{tab:centrifuges}) to match the cascade design describe in
\cite{glaser.2008} and \cite{walker.2017} using P1-type centrifuges.

\begin{table}[htb]
\centering
\caption{Summary of the centrifuge parameters.}
\begin{tabular}{cccccccc}
\toprule
$T$[K] & $v$[m/s]    & $h$[m] & $d$[m]   & $x$   & $F$[mg/s]  & $L/F$ & $e$  \\
\midrule
320    & $320$       & $1.8$  & $0.105$  & $10^{3}$ & $13$       & 2     & 1.0  \\
\bottomrule
\end{tabular}

  \label{tab:centrifuges}
\end{table}

\subsection{Cascade Design}

The cascade is built as an ideal cascade, with no losses in the separative work,
which corresponds to $\alpha =\beta = const$ for all stages of the cascade, where
$\alpha$ and $\beta$ represent the feed to product and the feed to
tails enrichment factors respectively.  $\alpha$ and $\beta$ can be expressed as function of
the abundance ($R$) or the enrichment ($N$) of respectively the product
($R'$, $N'$) and the feed ($R$, $N$) and the feed and the tails ($R''$, $N''$) such
as:
\begin{subequations} \label{eq:alphabeta}
    \begin{equation} \label{eq:alpha_def}
        \alpha = \frac{R'}{R} = \frac{N'}{1-N'}\frac{1-N}{N} 
\end{equation}
\\
\begin{equation}\label{eq:beta-def}
        \beta = \frac{R}{R''} = \frac{N}{1-N}\frac{1-N''}{N''} 
\end{equation}
\end{subequations}

As detailed in \cite{avery} it is also possible to derive $\alpha$ from the
first principle, and express it as a function of the feed rate $F$, the
separative performance $\delta U(\theta)$ and the cut $\theta$:

    \begin{equation} \label{eq:alpha}
    \alpha = \sqrt{\frac{2\delta U}{F} \frac{1-\theta}{\theta}}+1
\end{equation}

From the mass conservation, $N = \theta N' + (1-\theta)N''$, and equations
\eqref{eq:alphabeta} it is possible to express $\beta$ as a function of the
feed abundance, $R$, the cut $\theta$ and $\alpha$:

\begin{equation}\label{eq:beta}
    \beta =   R \left(\dfrac{1-\theta}
                     {\dfrac{R}{R+1}- \theta \dfrac{\alpha R}{1+\alpha R}} -1\right)
\end{equation}


From equation \eqref{eq:alpha} and \eqref{eq:beta} it is possible to determine
the cut, $\theta$ required to build an ideal cascade:
\begin{eqnarray}
    \theta_{i} = \dfrac{N_{i} - \dfrac{1}{1 + \beta/R_{i}}}{ \dfrac{\alpha R_{i}}{1 + \alpha R_{i}} -
           \dfrac{1}{1 + \beta/R_{i}}}
           \label{eq:theta}
\end{eqnarray}

As $\alpha_{i}$ and $\beta_{i}$ remain constant, only the value of the cut,
$\theta_{i}$, changes across the different stages of a cascade.  This algorithm
assumes that the corresponding separative power $\delta U$ (not re-computed) can
be achieved with the chosen centrifuge design, tuning other operational
parameter such as the rotation speed, the counter-current flow ratio, etc.  Once
$\theta_{i}$ is determined, it is possible to compute the product and the tail
assay.

The design of the cascade is performed through 2 steps.  First one determines
the configuration and number of stages, adding stages until the product assay of
the final stage is greater or equal the product targeted assay, and similarly
the tails assay is less or equal the tails desired assay.  This determines the
number of enriching and stripping stages as well as their enrichment properties
($N_{i}$, $N'_{i}$, $N''_{i}$,$\theta_{i}$i).


The second step determines the relative flows at each stages, solving the linear
flow equation, \eqref{eq:flow}.
The cascade can then be populated with actual machines until the maximum number
available of machines is reached.

\begin{equation}
\setcounter{MaxMatrixCols}{20}
\begin{bmatrix}
     -1      & 1-\theta_{_{S+1}} & 0                 & ...  & 0            & 0            & 0             & 0             & 0             & ... & 0               & 0  & 0 \\
\theta_{_S}  & -1                & 1-\theta_{_{S+2}} & ...  & 0            & 0            & 0             & 0             & 0             & ... & 0               & 0  & 0 \\
             &                   &                   &      &              &              & ...           &               &               &     &                 &    &   \\
 0           & 0                 & 0                 & ...  & \theta_{_-2} & -1           & 1-\theta_{_0} & 0             & 0             & ... & 0               & 0  & 0 \\
 0           & 0                 & 0                 & ...  & 0            & \theta_{_-1} & -1            & 1-\theta_{_1} & 0             & ... & 0               & 0  & 0 \\
 0           & 0                 & 0                 & ...  & 0            & 0            & \theta_{_0}   & -1            & 1-\theta_{_2} & ... & 0               & 0  & 0 \\
             &                   &                   &      &              &              & ...           &               &               &     &                 &    &   \\
 0           & 0                 & 0                 & ...  & 0            & 0            & 0             & 0             & 0             & ... & \theta_{_{E-2}} & -1 & 1-\theta_{_E} \\
 0           & 0                 & 0                 & ...  & 0            & 0            & 0             & 0             & 0             & ... & 0               & \theta_{_{E-1}} & -1
 \end{bmatrix}
 \times
 \begin{bmatrix}
     F_{_{S}}   \\
     F_{_{S+1}} \\
     \cdots     \\
     F_{_{-1}}  \\
     F_{_{0} }  \\
     F_{_{1} }  \\
     \cdots     \\
     F_{_{E-1}} \\
     F_{_{E}}
 \end{bmatrix}
 =
 \begin{bmatrix}
     0      \\
     0      \\
     \cdots \\
     0      \\
     F      \\
     0      \\
     \cdots \\
     0      \\
     0
\end{bmatrix}
%\caption{caption needed!}
\label{eq:flow}
\end{equation}



\subsection{Misuse models}

Little information is available about optimising an existing enrichment cascade
that is being fed with a feed enrichment that does not match the design
enrichment. So far 3 different methods have been investigated. 

The first one assumes that no change are been made to the cascade, i.e $\delta
U$, $F$ and $\theta$ are fixed across all stages. The second one assumes the cut
value at each stage is retuned to maintain the ideal state of the cascade,
$\alpha$ and $\beta$ remain fixed. The last one, described in \cite{walker.2017}
assumes the tails to product enriching factor and the cut remain constants ($\gamma =
\alpha\times\beta$). Models behaviors and assumptions are summarized in Tab.
\ref{tab:models}.

\begin{table}[htb]
\centering
  \caption{Summary of misuse model properties.}
\begin{tabular}{l|ccc}
\toprule

Model                &    A                 & B                  & C  \\
\midrule
Constant parameters  & $\alpha_i, \theta_i$ & $\alpha_i=\beta_i$ & $\gamma_i=\alpha_i .\beta_i, \theta_i$       \\
Varying parameters   & $\beta_i$            & $\theta_i$         & $\alpha_i, \beta_i$                     \\
Assays determination & blended              & ideal              & blended                  \\
Flow                 & unchanged            & reduced            & unchanged       \\

\bottomrule
\end{tabular}
  \label{tab:models}
\end{table}


\subsubsection{Model A}

The tuning method A does not re-optimize $\theta_i$ keeping the same flow as the
ideal configuration. From equation \eqref{eq:alpha}, maintaining $\delta U$, $F$
and $\theta$ unchanged implies $\alpha$ remains unchanged as well. According to
equation \eqref{eq:beta}, when $\alpha$ and $\theta$ are fixed, if the feed
assay ($N$) changes, $\beta$ will change accordingly.  This breaks the
ideal status of the cascade, i.e. $N_{i} \neq N'_{i-1} \neq N''_{i+1}$.


In order to compute the proper product and tails assay at each stage, the tails
and the product from the next and the previous stage respectively must be
blended in order to determine the correct stage feed assay. All feed assays are
iteratively updated, blending the proper product and tails, then using the
updated feed assay, the new product and tails assays are recomputed. This
process is repeated until the sum of the square difference in assays is smaller
than $10^{-8}$.  As the cut remain fixed at each stage the flows do not need to
be recomputed.

This model assumes that it is possible to maintain the separative power of a
centrifuges, $\delta U$, for any feed assays $N$ while maintaining its cut
$\theta$ and feed flow $F$.

\subsubsection{Model B}

Using the second method, the cut value at each stage $\theta_i$, is retuned in
order to maintain the $\alpha_i$ and $\beta_i$ at their original values
(equation \eqref{eq:theta}). The cascade remaining ideal, the product and tails
assay at each stages are easily determined using equations \eqref{eq:alphabeta}.

As the cut values change, the relative flow rates between the different stage
are recomputed using equation \eqref{eq:flow}. The flow rates are determinted as
the largest flow rates allowed by the cascade design, number of centrifuges
limiting the flow at each stage.

This model assumes that it is possible to tune a centrifuge separative power
$\delta U$, for any feed assay $N$, cut $\theta$ and feed flow $F$, in order to
maintain its constant feed to product enrichment factor $\alpha$.




\subsubsection{Model C}
The last model assumes that the tails to product enrichment factor remains
constant regardless to the feed assays. To compute the response of the cascade
one need to determine $\alpha$ and $\beta$ such that their product and
$\theta$ remain fixed. 
From equations \eqref{eq:alphabeta} and the assay conservation equation $N =
\theta N' + (1-\theta)N''$ it is possible to express the product $N'$ as a function of
the feed assay $N$, $\gamma$ and the cut $\theta$ as one solution of the second
order equation \eqref{eq:gamma_p}:

\begin{equation}\label{eq:gamma_p}
    \theta(\gamma-1)N'^2+((N+\theta)(\gamma-1)+1)N'-N\gamma = 0
\end{equation}


The only solution allowing product assay to range between 0 and 1 is the
following :
\begin{equation}\label{eq:model_b_sol}
    N' = \frac{N+\theta}{2\theta} +
         \frac{1 - \sqrt{\gamma^{2}(N-\theta)^{2}
                         + 2\gamma( N^{2} + N - \theta^{2} + \theta)
                         + (N + \theta + 1)^{2}}}
              {2\theta(\gamma - 1)}
\end{equation}
Once the product assay is known, one can trivially determine the tails assay,
$\alpha$ and $\beta$ using equations \eqref{eq:alphabeta} and mass
conservation.

Similar to model A, because the cut values remain constant, the flows don't
need to be recomputed, and the correct assays, $\alpha$ and $\beta$ are
determined through iterative blending of the product assays of the previous
stage and the tails assay of the next stage using equation
\eqref{eq:model_b_sol}.

This model assumes that it is possible to tune the centrifuge separative power
$\delta U$ in order to maintain, for any feed assay $N$, its tails to product
enrichment factor $\gamma$, while maintaining its cut $\theta$ and feed flow
$F$.

